{% extends "base.html" %}

{% block meta_description %}Welcome to K.'s personal space. Explore thoughts on humanity, art, and ideas, and view daily
observations through photography.{% endblock %}

{% block content %}
<div class="maliko-grid">

    <div class="grid-left-sidebar">
        <div class="vertical-text">recording life</div>
    </div>

    <div class="content-area">
        <h1 class="hero-title">
            Hello World, <br>
            <span class="name-part" id="typed-text"></span>
        </h1>

        <div class="hero-quotes-container">
            <div class="hero-quote" id="hero-quote-1">
                <p class="hero-text">Shall I compare thee to a summer's day? Thou art more lovely and more temperate:
                    Rough winds do shake the darling buds of May, And summer's lease hath all too short a date</p>
            </div>
            <div class="hero-quote" id="hero-quote-2" style="display: none;">
                <p class="hero-text"></p>
            </div>
            <div class="hero-quote" id="hero-quote-3" style="display: none;">
                <p class="hero-text"></p>
            </div>
            <div class="hero-quote" id="hero-quote-4" style="display: none;">
                <p class="hero-text"></p>
            </div>
        </div>
        <a href="{{ url_for('blog_index') }}" class="btn-consult">Explore what's in my brain</a>
    </div>

    <div class="image-area">
        <img src="{{ url_for('static', filename='personal_images/my_photo.png') }}" alt="My photo" class="img-fluid">
    </div>
    <div class="grid-right-sidebar"></div>

</div>


<!-- Gallery Section -->
<section id="gallery" class="section">
    <div class="container">
        {% if recent_photos %}
        <div class="gallery-grid">
            {% for photo in recent_photos %}
            <div class="gallery-item"
                onclick="openPhotoModal('{{ photo.filename }}', {{ photo.title | tojson }}, '{{ photo.created_at.strftime('%b %d, %Y') }}')">
                <img src="{{ url_for('static', filename='gallery_images/' + photo.filename) }}" alt="{{ photo.title }}">
                <div class="gallery-overlay">
                    <div class="gallery-title">{{ photo.title }}</div>
                    <div class="gallery-date">{{ photo.created_at.strftime('%b %d, %Y') }}</div>
                </div>
            </div>
            {% endfor %}
        </div>
        <div class="text-center mt-4">
            <a href="{{ url_for('gallery') }}" class="btn btn-outline-dark">View All Photos â†’</a>
        </div>
        {% else %}
        <div class="placeholder-section">
            <div class="placeholder-icon">ðŸ“·</div>
            <div class="placeholder-text">No photos yet. Start capturing moments!</div>
            <a href="{{ url_for('gallery') }}" class="btn btn-dark">Upload Your First Photo</a>
        </div>
        {% endif %}
    </div>
</section>

<!-- Section Divider -->
<div class="container my-3">
    <div class="position-relative text-center">
        <div class="position-absolute top-50 start-0 w-100 translate-middle-y" aria-hidden="true">
            <div class="border-top" style="border-color: #dee2e6;"></div>
        </div>
        <div class="position-relative d-inline-block px-3 fw-bold text-dark" style="background-color: #f8f9fa;">
            Humanity
        </div>
    </div>
</div>

<!-- Humanity Section -->
<section id="humanity" class="section bg-light py-4">
    <div class="container">
        {% if recent_posts %}
        <div class="row">
            {% for post in recent_posts %}
            <div class="col-md-4 mb-3">
                <div class="card h-100 shadow-sm border-0">
                    {% if post.media_type == 'image' %}
                    <img src="{{ url_for('static', filename='blog_media/' + post.media_filename) }}"
                        class="card-img-top" alt="{{ post.title }}" style="height: 200px; object-fit: cover;">
                    {% endif %}
                    <div class="card-body">
                        <h5 class="card-title h6">
                            <a href="{{ url_for('post', post_id=post.id) }}"
                                class="text-decoration-none text-dark stretched-link">
                                {{ post.title }}
                            </a>
                        </h5>
                        <p class="card-text text-muted small mb-2">
                            {{ post.created_at.strftime('%B %d, %Y') }}
                        </p>
                        <p class="card-text small text-secondary">
                            {{ post.content|striptags|truncate(100) }}
                        </p>
                    </div>
                </div>
            </div>
            {% endfor %}
        </div>
        <div class="text-center mt-3">
            <a href="{{ url_for('blog_index') }}" class="btn btn-outline-dark">Read More Stories â†’</a>
        </div>
        {% else %}
        <div class="placeholder-section">
            <div class="placeholder-icon">ðŸ‘¥</div>
            <div class="placeholder-text">Exploring the human experience, connections, and stories that shape our world.
            </div>
            <p class="text-muted">No stories yet. Be the first to share one!</p>
            <a href="{{ url_for('blog_index') }}" class="btn btn-dark">Visit Blog</a>
        </div>
        {% endif %}
    </div>
</section>

<!-- Section Divider -->
<div class="container my-3">
    <div class="position-relative text-center">
        <div class="position-absolute top-50 start-0 w-100 translate-middle-y" aria-hidden="true">
            <div class="border-top" style="border-color: #dee2e6;"></div>
        </div>
        <div class="position-relative d-inline-block px-3 fw-bold text-dark" style="background-color: #fff;">
            Collections
        </div>
    </div>
</div>

<!-- Collections Section -->
<section id="collections" class="section py-4">
    <div class="container">
        <div class="row g-3">
            <!-- Library -->
            <div class="col-md-3 col-6">
                <a href="{{ url_for('library_index') }}" class="text-decoration-none">
                    <div class="card h-100 border-0 shadow-sm text-center p-3 hover-card">
                        <div class="mb-2">
                            <svg width="48" height="48" viewBox="0 0 24 24" fill="none" stroke="currentColor"
                                stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="text-primary">
                                <path d="M4 19.5A2.5 2.5 0 0 1 6.5 17H20"></path>
                                <path d="M6.5 2H20v20H6.5A2.5 2.5 0 0 1 4 19.5v-15A2.5 2.5 0 0 1 6.5 2z"></path>
                            </svg>
                        </div>
                        <h5 class="text-dark fw-bold">Library</h5>
                        <p class="text-muted small mb-0">Curated books & resources</p>
                    </div>
                </a>
            </div>
            <!-- Fragments -->
            <div class="col-md-3 col-6">
                <a href="{{ url_for('fragmented_quotes_collection') }}" class="text-decoration-none">
                    <div class="card h-100 border-0 shadow-sm text-center p-3 hover-card">
                        <div class="mb-2">
                            <svg width="48" height="48" viewBox="0 0 24 24" fill="none" stroke="currentColor"
                                stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="text-warning">
                                <path
                                    d="M21 16V8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73l7 4a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16z">
                                </path>
                                <polyline points="7.5 4.21 12 6.81 16.5 4.21"></polyline>
                                <polyline points="7.5 19.79 7.5 14.6 3 12"></polyline>
                                <polyline points="21 12 16.5 14.6 16.5 19.79"></polyline>
                                <polyline points="3.27 6.96 12 12.01 20.73 6.96"></polyline>
                                <line x1="12" y1="22.08" x2="12" y2="12"></line>
                            </svg>
                        </div>
                        <h5 class="text-dark fw-bold">Fragments</h5>
                        <p class="text-muted small mb-0">Bits and pieces</p>
                    </div>
                </a>
            </div>
            <!-- Intellectual -->
            <div class="col-md-3 col-6">
                <a href="{{ url_for('intellectual_collection') }}" class="text-decoration-none">
                    <div class="card h-100 border-0 shadow-sm text-center p-3 hover-card">
                        <div class="mb-2">
                            <svg width="48" height="48" viewBox="0 0 24 24" fill="none" stroke="currentColor"
                                stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="text-info">
                                <circle cx="12" cy="12" r="10"></circle>
                                <path d="M9.09 9a3 3 0 0 1 5.83 1c0 2-3 3-3 3"></path>
                                <line x1="12" y1="17" x2="12.01" y2="17"></line>
                            </svg>
                        </div>
                        <h5 class="text-dark fw-bold">Intellectual</h5>
                        <p class="text-muted small mb-0">Abstract thoughts</p>
                    </div>
                </a>
            </div>
            <!-- Book Photos -->
            <div class="col-md-3 col-6">
                <a href="{{ url_for('books_collection') }}" class="text-decoration-none">
                    <div class="card h-100 border-0 shadow-sm text-center p-3 hover-card">
                        <div class="mb-2">
                            <svg width="48" height="48" viewBox="0 0 24 24" fill="none" stroke="currentColor"
                                stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="text-success">
                                <rect x="3" y="3" width="18" height="18" rx="2" ry="2"></rect>
                                <circle cx="8.5" cy="8.5" r="1.5"></circle>
                                <polyline points="21 15 16 10 5 21"></polyline>
                            </svg>
                        </div>
                        <h5 class="text-dark fw-bold">Book Photos</h5>
                        <p class="text-muted small mb-0">Literary moments</p>
                    </div>
                </a>
            </div>
            <!-- Reading Quotes -->
            <div class="col-md-3 col-6">
                <a href="{{ url_for('reading_quotes_collection') }}" class="text-decoration-none">
                    <div class="card h-100 border-0 shadow-sm text-center p-3 hover-card">
                        <div class="mb-2">
                            <svg width="48" height="48" viewBox="0 0 24 24" fill="none" stroke="currentColor"
                                stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="text-danger">
                                <path d="M2 3h6a4 4 0 0 1 4 4v14a3 3 0 0 0-3-3H2z"></path>
                                <path d="M22 3h-6a4 4 0 0 0-4 4v14a3 3 0 0 1 3-3h7z"></path>
                            </svg>
                        </div>
                        <h5 class="text-dark fw-bold">Reading Quotes</h5>
                        <p class="text-muted small mb-0">Words that resonate</p>
                    </div>
                </a>
            </div>
            <!-- Videos -->
            <div class="col-md-3 col-6">
                <a href="{{ url_for('videos_collection') }}" class="text-decoration-none">
                    <div class="card h-100 border-0 shadow-sm text-center p-3 hover-card">
                        <div class="mb-2">
                            <svg width="48" height="48" viewBox="0 0 24 24" fill="none" stroke="currentColor"
                                stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"
                                class="text-secondary">
                                <polygon points="23 7 16 12 23 17 23 7"></polygon>
                                <rect x="1" y="5" width="15" height="14" rx="2" ry="2"></rect>
                            </svg>
                        </div>
                        <h5 class="text-dark fw-bold">Videos</h5>
                        <p class="text-muted small mb-0">Visual stories</p>
                    </div>
                </a>
            </div>
            <!-- Guitar -->
            <div class="col-md-3 col-6">
                <a href="{{ url_for('guitar_collection') }}" class="text-decoration-none">
                    <div class="card h-100 border-0 shadow-sm text-center p-3 hover-card">
                        <div class="mb-2">
                            <svg width="48" height="48" viewBox="0 0 24 24" fill="none" stroke="currentColor"
                                stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="text-dark">
                                <path d="M9 18V5l-1.5-1.5L5 5v13a2 2 0 0 0 2 2h10a2 2 0 0 0 2-2V5l-2.5-1.5L15 5v13">
                                </path>
                                <circle cx="7" cy="16" r="2"></circle>
                                <circle cx="17" cy="16" r="2"></circle>
                            </svg>
                        </div>
                        <h5 class="text-dark fw-bold">Guitar</h5>
                        <p class="text-muted small mb-0">Melodies & chords</p>
                    </div>
                </a>
            </div>
            <!-- Exercises -->
            <div class="col-md-3 col-6">
                <a href="{{ url_for('exercises_collection') }}" class="text-decoration-none">
                    <div class="card h-100 border-0 shadow-sm text-center p-3 hover-card">
                        <div class="mb-2">
                            <svg width="48" height="48" viewBox="0 0 24 24" fill="none" stroke="currentColor"
                                stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="text-danger">
                                <circle cx="12" cy="8" r="7"></circle>
                                <polyline points="8.21 13.89 7 23 12 20 17 23 15.79 13.88"></polyline>
                            </svg>
                        </div>
                        <h5 class="text-dark fw-bold">Exercises</h5>
                        <p class="text-muted small mb-0">Physical journey log</p>
                    </div>
                </a>
            </div>
        </div>
    </div>
</section>

<!-- Section Divider -->
<div class="container my-3">
    <div class="position-relative text-center">
        <div class="position-absolute top-50 start-0 w-100 translate-middle-y" aria-hidden="true">
            <div class="border-top" style="border-color: #dee2e6;"></div>
        </div>
        <div class="position-relative d-inline-block px-3 fw-bold text-dark" style="background-color: #f8f9fa;">
            Ideas
        </div>
    </div>
</div>

<!-- Ideas Section -->
<section id="ideas-preview" class="section bg-light py-4">
    <div class="container">
        <div class="row align-items-center">
            <div class="col-md-6 mb-3 mb-md-0">
                <h2 class="display-6 fw-bold mb-2">Perspectives</h2>
                <p class="lead text-muted mb-3 fs-6">Exploring thoughts, concepts, and innovations worth sharing.</p>
                <a href="{{ url_for('ideas') }}" class="btn btn-dark btn-sm">Explore Ideas â†’</a>
            </div>
            <div class="col-md-6">
                <div class="card border-0 shadow p-3" style="background: #fff; border-radius: 12px;">
                    <figure class="mb-0">
                        <blockquote class="blockquote">
                            <p class="fs-6 fst-italic mb-2" id="random-idea-quote">"The only way to do great work is to
                                love what you do."</p>
                        </blockquote>
                        <figcaption class="blockquote-footer mb-0">
                            <cite title="Source Title" id="random-idea-author">Steve Jobs</cite>
                        </figcaption>
                    </figure>
                </div>
            </div>
        </div>
    </div>
</section>

<!-- Section Divider -->
<div class="container my-3">
    <div class="position-relative text-center">
        <div class="position-absolute top-50 start-0 w-100 translate-middle-y" aria-hidden="true">
            <div class="border-top" style="border-color: #dee2e6;"></div>
        </div>
        <div class="position-relative d-inline-block px-3 fw-bold text-dark" style="background-color: #fff;">
            Lab
        </div>
    </div>
</div>

<!-- Lab Section -->
<section id="lab-preview" class="section py-4">
    <div class="container">
        {% if lab_projects %}
        <div class="row g-3">
            {% for project in lab_projects %}
            <div class="col-md-4">
                <div class="card h-100 border-0 shadow-sm hover-card" style="border-radius: 12px; overflow: hidden;">
                    {% if project.image_filename.startswith('http') %}
                    <img src="{{ project.image_filename }}" class="card-img-top" alt="{{ project.title }}"
                        style="height: 150px; object-fit: cover;">
                    {% else %}
                    <img src="{{ url_for('static', filename=project.image_filename) }}" class="card-img-top"
                        alt="{{ project.title }}" style="height: 150px; object-fit: cover;">
                    {% endif %}
                    <div class="card-body p-3">
                        <h5 class="card-title fw-bold h6">{{ project.title }}</h5>
                        <p class="card-text text-muted small text-truncate mb-0">{{ project.description }}</p>
                        <a href="{{ project.github_url }}" target="_blank" class="stretched-link"></a>
                    </div>
                </div>
            </div>
            {% endfor %}
        </div>
        <div class="text-center mt-4">
            <a href="{{ url_for('lab') }}" class="btn btn-outline-dark btn-sm">View All Projects â†’</a>
        </div>
        {% else %}
        <div class="text-center py-4">
            <div class="fs-1 mb-2">ðŸ§ª</div>
            <p class="text-muted small">Experiments in progress. Check back soon!</p>
            <a href="{{ url_for('lab') }}" class="btn btn-dark btn-sm">Visit Lab</a>
        </div>
        {% endif %}
    </div>
</section>

<!-- Photo Modal -->
<div id="photoModal" class="modal fade" tabindex="-1">
    <div class="modal-dialog modal-lg modal-dialog-centered">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="modalPhotoTitle">Photo Title</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
            </div>
            <div class="modal-body text-center">
                <img id="modalPhotoImg" src="" alt="" class="img-fluid" style="max-height: 70vh; object-fit: contain;">
                <div class="mt-3 text-muted" id="modalPhotoDate">Date</div>
            </div>
        </div>
    </div>
</div>
{% endblock %}

{% block scripts %}
<script src="https://unpkg.com/typed.js@2.1.0/dist/typed.umd.js"></script>
<script src="{{ url_for('static', filename='js/text_rotator.js') }}" defer></script>
<script>
    // Initialize Typed.js for animated text effect
    var typed = new Typed('#typed-text', {
        strings: [
            '<span style="color: #777">I am K.</span>',
            '<span style="color: #dc3545">æ ¼ç‰©.</span>',
            '<span style="color: #6f42c1">è‡´çŸ¥.</span>',
            '<span style="color: #0d6efd">Observation.</span>',
            '<span style="color: #198754">Exploration.</span>',
            '<span style="color: #fd7e14">Discovery.</span>'
        ],
        typeSpeed: 50,
        backSpeed: 30,
        backDelay: 1500,
        startDelay: 500,
        loop: true,
        showCursor: true,
        cursorChar: '|',
        html: true
    });

    // Photo Modal Function
    function openPhotoModal(filename, title, date) {
        const modal = new bootstrap.Modal(document.getElementById('photoModal'));
        document.getElementById('modalPhotoTitle').textContent = title;
        document.getElementById('modalPhotoImg').src = "{{ url_for('static', filename='gallery_images') }}/" + filename;
        document.getElementById('modalPhotoDate').textContent = date;
        modal.show();
    }

    // Hero Quotes Rotation Functionality
    const allQuotes = {{ quotes | tojson }};
    const heroQuotes = [
        document.getElementById('hero-quote-1'),
        document.getElementById('hero-quote-2'),
        document.getElementById('hero-quote-3'),
        document.getElementById('hero-quote-4')
    ];

    function getRandomQuote() {
        if (!allQuotes || allQuotes.length === 0) return { text: "No quotes available", author: "" };
        return allQuotes[Math.floor(Math.random() * allQuotes.length)];
    }

    function initializeHeroQuotes() {
        if (!allQuotes || allQuotes.length === 0) return;

        // Initialize all quotes with random content
        heroQuotes.forEach((quoteDiv, index) => {
            const quote = getRandomQuote();
            const textEl = quoteDiv.querySelector('.hero-text');
            textEl.textContent = quote.text;

            // Start with first quote visible, others hidden
            if (index === 0) {
                quoteDiv.style.display = 'block';
                textEl.style.opacity = 1;
            } else {
                quoteDiv.style.display = 'none';
                textEl.style.opacity = 0;
            }
        });
    }

    function rotateHeroQuotes() {
        if (!allQuotes || allQuotes.length === 0) return;

        // Find current visible quote
        let currentIndex = -1;
        heroQuotes.forEach((quoteDiv, index) => {
            if (quoteDiv.style.display !== 'none') {
                currentIndex = index;
            }
        });

        // Calculate next index
        const nextIndex = (currentIndex + 1) % heroQuotes.length;

        // Fade out current quote
        const currentQuote = heroQuotes[currentIndex];
        const currentText = currentQuote.querySelector('.hero-text');
        currentText.style.opacity = 0;

        setTimeout(() => {
            // Hide current quote
            currentQuote.style.display = 'none';

            // Show and fade in next quote
            const nextQuote = heroQuotes[nextIndex];
            const nextText = nextQuote.querySelector('.hero-text');

            // Update content with new random quote
            const newQuote = getRandomQuote();
            nextText.textContent = newQuote.text;

            nextQuote.style.display = 'block';
            setTimeout(() => {
                nextText.style.opacity = 1;
            }, 50);
        }, 500);
    }

    // Initialize and start rotation
    if (allQuotes && allQuotes.length > 0) {
        initializeHeroQuotes();

        // Set initial random quote for Ideas section
        const ideasQuoteEl = document.getElementById('random-idea-quote');
        const ideasAuthorEl = document.getElementById('random-idea-author');

        if (ideasQuoteEl && ideasAuthorEl) {
            const initialQuote = getRandomQuote();
            ideasQuoteEl.textContent = `"${initialQuote.text}"`;
            ideasAuthorEl.textContent = initialQuote.author;

            // Add fade transition CSS for Ideas quote
            ideasQuoteEl.style.transition = 'opacity 0.5s ease-in-out';
            ideasAuthorEl.style.transition = 'opacity 0.5s ease-in-out';

            // Function to rotate Ideas section quote
            function rotateIdeasQuote() {
                // Fade out
                ideasQuoteEl.style.opacity = 0;
                ideasAuthorEl.style.opacity = 0;

                setTimeout(() => {
                    // Update content with new random quote
                    const newQuote = getRandomQuote();
                    ideasQuoteEl.textContent = `"${newQuote.text}"`;
                    ideasAuthorEl.textContent = newQuote.author;

                    // Fade in
                    setTimeout(() => {
                        ideasQuoteEl.style.opacity = 1;
                        ideasAuthorEl.style.opacity = 1;
                    }, 50);
                }, 500);
            }

            // Start Ideas quote rotation every 7 seconds
            setInterval(rotateIdeasQuote, 7000);
        }

        // Start hero quotes rotation every 5 seconds
        setInterval(rotateHeroQuotes, 5000);
    }

    // Add CSS for smooth transitions
    const style = document.createElement('style');
    style.innerHTML = `
        .hero-quote .hero-text {
            transition: opacity 0.5s ease-in-out;
        }
        .hero-quotes-container {
            position: relative;
            min-height: 80px;
        }
    `;
    document.head.appendChild(style);
</script>
{% endblock %}