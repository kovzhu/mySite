{% extends "base.html" %}

{% block title %}Ideas - K.{% endblock %}

{% block content %}
<div class="container py-5">
    <!-- Quotes Section -->
    <section class="mb-5">
        <h2 class="display-4 mb-5 text-center"
            style="font-family: 'Inter', sans-serif; font-weight: 900; letter-spacing: -1px;">Perspectives</h2>
        <div class="row g-4" id="quotes-grid">
            <!-- 6 Quote Slots -->
            {% for i in range(6) %}
            <div class="col-md-6 col-lg-4">
                <div class="card h-100 border-0 shadow-sm quote-card"
                    style="background: #ffffff; transition: transform 0.3s ease; border-radius: 12px;">
                    <div class="card-body d-flex flex-column justify-content-center align-items-center text-center p-4">
                        <p class="card-text fs-5 fst-italic quote-text mb-3"
                            style="font-family: 'Georgia', serif; color: #333; min-height: 80px; display: flex; align-items: center; justify-content: center;">
                            Loading...</p>
                        <footer class="blockquote-footer mt-auto quote-author"
                            style="font-family: 'Inter', sans-serif; font-size: 0.9rem;"></footer>
                    </div>
                </div>
            </div>
            {% endfor %}
        </div>
    </section>

    <hr class="my-5" style="opacity: 0.1;">

    <!-- Books Section -->
    <section>
        <h2 class="display-4 mb-5 text-center"
            style="font-family: 'Inter', sans-serif; font-weight: 900; letter-spacing: -1px;">Library</h2>
        <div class="row g-4">
            {% for category in categories %}
            <div class="col-md-4 col-lg-3">
                <a href="{{ url_for('library_category', category=category) }}" class="text-decoration-none">
                    <div class="card h-100 border-0 shadow-sm hover-card" style="transition: transform 0.3s ease;">
                        <div class="card-body d-flex flex-column justify-content-center align-items-center p-5 text-center"
                            style="background: #f8f9fa; border-radius: 12px;">
                            <div class="mb-3" style="font-size: 3rem;">ðŸ“š</div>
                            <h5 class="card-title fw-bold text-dark mb-0">{{ category }}</h5>
                        </div>
                    </div>
                </a>
            </div>
            {% else %}
            <div class="col-12 text-center">
                <p class="text-muted">No categories found.</p>
            </div>
            {% endfor %}
        </div>
    </section>
</div>
{% endblock %}

{% block scripts %}
<script>
    const allQuotes = {{ quotes | tojson }};
    const quoteCards = document.querySelectorAll('.quote-card');

    function getRandomQuote() {
        if (!allQuotes || allQuotes.length === 0) return { text: "No quotes available", author: "" };
        return allQuotes[Math.floor(Math.random() * allQuotes.length)];
    }

    function updateCard(card) {
        const textEl = card.querySelector('.quote-text');
        const authorEl = card.querySelector('.quote-author');

        // Fade out
        textEl.style.opacity = 0;
        authorEl.style.opacity = 0;

        setTimeout(() => {
            const quote = getRandomQuote();
            textEl.textContent = `"${quote.text}"`;
            authorEl.textContent = quote.author;

            // Fade in
            textEl.style.opacity = 1;
            authorEl.style.opacity = 1;
        }, 500);
    }

    if (allQuotes && allQuotes.length > 0) {
        quoteCards.forEach(card => {
            // Initial set
            const quote = getRandomQuote();
            card.querySelector('.quote-text').textContent = `"${quote.text}"`;
            card.querySelector('.quote-author').textContent = quote.author;

            // Set random interval for rotation (between 5s and 12s)
            const interval = Math.floor(Math.random() * 7000) + 5000;

            setInterval(() => {
                updateCard(card);
            }, interval);
        });
    }

    // Add CSS transition for opacity
    const style = document.createElement('style');
    style.innerHTML = `
        .quote-text, .quote-author {
            transition: opacity 0.5s ease-in-out;
        }
        .quote-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 1rem 3rem rgba(0,0,0,.1) !important;
        }
    `;
    document.head.appendChild(style);
</script>
{% endblock %}